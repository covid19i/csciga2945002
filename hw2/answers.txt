HW2 - HPC - Ilyeech Kishore - N12945596

Q2)
System Architecture:
  Processor Name:	Quad-Core Intel Core i5
  Processor Speed:	1.4 GHz (Turbo Boost up to 3.9GHz)
  Number of Processors:	1
  Total Number of Cores:	4
  L2 Cache (per Core):	256 KB
  L3 Cache:	6 MB
  Memory:	16 GB 2133 MHz LPDDR3



    double flops = 2*m*n*k*NREPEATS/(1e9 * time);
    double bandwidth = (m*k+k*n+2*m*n)*NREPEATS/(1e9 * time);
Since there are two calculations (one multiplication + one addition) in the inner most loop, flops = 2 * m * n * k *NREPEATS;


With various sizes of blocks:
Ilyeechs-MacBook-Pro:HW2 ilyeech$ ./MMult1
Block size = 16:
Dimension       Time    Gflop/s       GB/s        Error
        16   0.618013   3.236183   0.404523 0.000000e+00
        32   0.614190   3.256366   0.203523 0.000000e+00
        64   0.672131   2.975847   0.092995 0.000000e+00
       128   0.765384   2.613960   0.040843 0.000000e+00
       256   1.155939   1.741671   0.013607 0.000000e+00
       512   3.425196   0.626967   0.002449 0.000000e+00
      1024   3.414555   0.628921   0.001228 0.000000e+00
      2048  28.508439   0.602624   0.000588 0.000000e+00
      4096 234.217722   0.586800   0.000287 0.000000e+00

Block size = 64:
 Dimension       Time    Gflop/s       GB/s        Error
        64   1.031919   1.938290   0.060572 0.000000e+00
       128   2.934014   0.681893   0.010655 0.000000e+00
       256   3.465481   0.580948   0.004539 0.000000e+00
       512   4.450341   0.482544   0.001885 0.000000e+00
      1024   4.851112   0.442679   0.000865 0.000000e+00
      2048  38.837161   0.442356   0.000432 0.000000e+00
      4096 335.808566   0.409278   0.000200 0.000000e+00

Block size=256:
 Dimension       Time    Gflop/s       GB/s        Error
       256   4.506534   0.446744   0.003490 0.000000e+00
       512   4.882071   0.439871   0.001718 0.000000e+00
      1024   4.954924   0.433404   0.000846 0.000000e+00
      2048  41.505232   0.413921   0.000404 0.000000e+00
      4096 344.796603   0.398609   0.000195 0.000000e+00

Block size = 1024:
Dimension       Time    Gflop/s       GB/s        Error
      1024  13.650606   0.157318   0.000307 0.000000e+00
      2048 111.605528   0.153934   0.000150 0.000000e+00

Optimal value for BLOCK SIZE: 16

WITH OMP:

With #pragma omp for schedule (dynamic, 4):
 Dimension       Time    Gflop/s       GB/s        Error
        64   0.136368  14.667361   0.458355 0.000000e+00
       128   0.049487  40.428456   0.631695 0.000000e+00
       256   0.044722  45.017350   0.351698 0.000000e+00
       512   0.048109  44.637877   0.174367 0.000000e+00
      1024   0.072503  29.619238   0.057850 0.000000e+00
      2048   0.846901  20.285570   0.019810 0.000000e+00
      4096   8.975206  15.313181   0.007477 0.000000e+00
      8192 107.515193  10.226570   0.002497 0.000000e+00

With #pragma omp for schedule (dynamic, 8):
 Dimension       Time    Gflop/s       GB/s        Error
        64   0.139222  14.366686   0.448959 0.000000e+00
       128   0.049297  40.584275   0.634129 0.000000e+00
       256   0.045827  43.931872   0.343218 0.000000e+00
       512   0.049335  43.528603   0.170034 0.000000e+00
      1024   0.078284  27.431961   0.053578 0.000000e+00
      2048   0.943384  18.210897   0.017784 0.000000e+00
      4096   9.606116  14.307443   0.006986 0.000000e+00

With #pragma omp for schedule (dynamic, 32):
 Dimension       Time    Gflop/s       GB/s        Error
        64   0.152917  13.080029   0.408751 0.000000e+00
       128   0.050380  39.711850   0.620498 0.000000e+00
       256   0.046078  43.692563   0.341348 0.000000e+00
       512   0.049320  43.541842   0.170085 0.000000e+00
      1024   0.076871  27.936200   0.054563 0.000000e+00
      2048   1.059672  16.212440   0.015832 0.000000e+00
      4096   9.895262  13.889370   0.006782 0.000000e+00

With #pragma omp for schedule (dynamic, 64):
Dimension       Time    Gflop/s       GB/s        Error
        64   0.207037   9.660876   0.301902 0.000000e+00
       128   0.072636  27.543959   0.430374 0.000000e+00
       256   0.057333  35.115307   0.274338 0.000000e+00
       512   0.048948  43.872756   0.171378 0.000000e+00
      1024   0.072103  29.783555   0.058171 0.000000e+00
      2048   0.908972  18.900328   0.018457 0.000000e+00
      4096   9.136296  15.043181   0.007345 0.000000e+00
      8192 106.451296  10.328776   0.002522 0.000000e+00

With #pragma omp for schedule (dynamic, 128):
Dimension       Time    Gflop/s       GB/s        Error
        64   0.208874   9.575910   0.299247 0.000000e+00
       128   0.133204  15.019692   0.234683 0.000000e+00
       256   0.088947  22.634444   0.176832 0.000000e+00
       512   0.059289  36.220608   0.141487 0.000000e+00
      1024   0.072666  29.552798   0.057720 0.000000e+00
      2048   0.855878  20.072801   0.019602 0.000000e+00
      4096   8.955562  15.346770   0.007494 0.000000e+00

With #pragma omp for schedule (dynamic, 512):
Dimension       Time    Gflop/s       GB/s        Error
        64   0.207620   9.633748   0.301055 0.000000e+00
       128   0.133580  14.977414   0.234022 0.000000e+00
       256   0.169591  11.871302   0.092745 0.000000e+00
       512   0.193050  11.123976   0.043453 0.000000e+00
      1024   0.193871  11.076869   0.021635 0.000000e+00
      2048   0.945620  18.167836   0.017742 0.000000e+00
      4096  10.112125  13.591501   0.006636 0.000000e+00

With #pragma omp for schedule (guided, 4)
Dimension       Time    Gflop/s       GB/s        Error
        64   0.135481  14.763389   0.461356 0.000000e+00
       128   0.052902  37.818665   0.590917 0.000000e+00
       256   0.044534  45.207390   0.353183 0.000000e+00
       512   0.047989  44.749498   0.174803 0.000000e+00
      1024   0.076135  28.206261   0.055090 0.000000e+00
      2048   0.888259  19.341058   0.018888 0.000000e+00
      4096   9.188283  14.958067   0.007304 0.000000e+00
      8192  85.044010  12.928737   0.003156 0.000000e+00

With #pragma omp for schedule (runtime)
 Dimension       Time    Gflop/s       GB/s        Error
        64   0.190204  10.515860   0.328621 0.000000e+00
       128   0.091477  21.870886   0.341733 0.000000e+00
       256   0.053184  37.854729   0.295740 0.000000e+00
       512   0.050032  42.922203   0.167665 0.000000e+00
      1024   0.070858  30.306862   0.059193 0.000000e+00
      2048   0.892628  19.246393   0.018795 0.000000e+00
      4096   8.995530  15.278583   0.007460 0.000000e+00
      8192 113.492221   9.687991   0.002365 0.000000e+00

#pragma omp for schedule (guided, 4) collapse(2) reduction(+:c)
 Dimension       Time    Gflop/s       GB/s        Error
        64   0.079542  25.145945   0.785811 0.000000e+00
       128   0.089526  22.347508   0.349180 0.000000e+00
       256   0.153983  13.074599   0.102145 0.000000e+00
       512   0.151034  14.218544   0.055541 0.000000e+00
      1024   0.333764   6.434138   0.012567 0.000000e+00
      2048   3.570437   4.811699   0.004699 0.000000e+00
      4096  28.468071   4.827828   0.002357 0.000000e+00

OMP parallel for gave the best performance with (guided, 4). Nested didnâ€™t work well. 

For Dimension = 4096, (guided, 4) gave a flop rate of 14.95 giga flops/ second. The maximum possible is 3.9*4 = 15.6 giga flops/ second with turbo boost (of Intel). Without turbo boost the max limit is 1.4*4 = 5.6 giga flops/second.
